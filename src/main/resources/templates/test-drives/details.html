<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:replace="fragments/layout :: head('Test Sürüşü Detayları')">
    <meta charset="UTF-8">
    <title>Test Sürüşü Detayları</title>
</head>
<body>
    <nav th:replace="fragments/layout :: navbar('test-drives')"></nav>

    <div class="container my-4">
        <div th:replace="fragments/layout :: alerts"></div>
        
        <div class="d-flex justify-content-between align-items-center mb-4">
            <h1>Test Sürüşü Detayları</h1>
            <div>
                <a th:href="@{/test-drives}" class="btn btn-outline-secondary">
                    <i class="bi bi-arrow-left"></i> Listeye Dön
                </a>
                <a th:href="@{/test-drives/{id}/edit(id=${testDrive.id})}" class="btn btn-primary">
                    <i class="bi bi-pencil"></i> Düzenle
                </a>
            </div>
        </div>
        
        <div class="row">
            <div class="col-md-8">
                <div class="card mb-4">
                    <div class="card-header bg-light">
                        <h5 class="mb-0">Test Sürüş Bilgileri</h5>
                    </div>
                    <div class="card-body">
                        <div class="row mb-3">
                            <div class="col-md-4 fw-bold">Test Sürüş ID:</div>
                            <div class="col-md-8" th:text="${testDrive.id}">1</div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-4 fw-bold">Müşteri:</div>
                            <div class="col-md-8">
                                <a th:href="@{/customers/{id}(id=${testDrive.customerId})}" th:text="${testDrive.customerName}">
                                    Ahmet Yılmaz
                                </a>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-4 fw-bold">Araç:</div>
                            <div class="col-md-8">
                                <a th:href="@{/vehicles/{id}(id=${testDrive.vehicleId})}" th:text="${testDrive.vehicleInfo}">
                                    Renault Clio 2023
                                </a>
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-4 fw-bold">Planlanan Tarih/Saat:</div>
                            <div class="col-md-8" th:text="${#temporals.format(testDrive.scheduledDateTime, 'dd/MM/yyyy HH:mm')}">
                                01/01/2023 14:30
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-4 fw-bold">Başlangıç Saati:</div>
                            <div class="col-md-8" th:text="${testDrive.actualStartTime != null ? #temporals.format(testDrive.actualStartTime, 'dd/MM/yyyy HH:mm') : '-'}">
                                01/01/2023 14:35
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-4 fw-bold">Bitiş Saati:</div>
                            <div class="col-md-8" th:text="${testDrive.actualEndTime != null ? #temporals.format(testDrive.actualEndTime, 'dd/MM/yyyy HH:mm') : '-'}">
                                01/01/2023 15:00
                            </div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-4 fw-bold">Sorumlu Personel:</div>
                            <div class="col-md-8" th:text="${testDrive.staffMemberName}">Mehmet Demir</div>
                        </div>
                        <div class="row mb-3">
                            <div class="col-md-4 fw-bold">Müşteri Geri Bildirimi:</div>
                            <div class="col-md-8" th:text="${testDrive.customerFeedback != null ? testDrive.customerFeedback : 'Henüz geri bildirim yok'}">
                                Araç çok konforlu, sürüş keyifli.
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-md-4">
                <div class="card mb-4">
                    <div class="card-header bg-light">
                        <h5 class="mb-0">Test Sürüş Durumu</h5>
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <div class="fw-bold mb-2">Mevcut Durum:</div>
                            <div>
                                <span th:class="${'badge bg-' + 
                                     (testDrive.status == T(dev.tunalime.SemesterProject.entity.TestDriveStatus).SCHEDULED ? 'info' : 
                                      testDrive.status == T(dev.tunalime.SemesterProject.entity.TestDriveStatus).COMPLETED ? 'success' : 
                                      testDrive.status == T(dev.tunalime.SemesterProject.entity.TestDriveStatus).CANCELLED ? 'danger' :
                                      'warning')}" 
                                     th:text="${testDrive.status}">
                                    SCHEDULED
                                </span>
                            </div>
                        </div>
                        
                        <div class="mb-3">
                            <div class="fw-bold mb-2">Durum Güncelle:</div>
                            <form th:action="@{/test-drives/{id}/status(id=${testDrive.id})}" method="post">
                                <div class="input-group">
                                    <select name="status" class="form-select">
                                        <option th:each="status : ${statuses}"
                                                th:value="${status}"
                                                th:text="${status}"
                                                th:selected="${status == testDrive.status}">
                                            SCHEDULED
                                        </option>
                                    </select>
                                    <button type="submit" class="btn btn-outline-primary">Güncelle</button>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
                
                <div class="card mb-4">
                    <div class="card-header bg-light">
                        <h5 class="mb-0">İşlemler</h5>
                    </div>
                    <div class="card-body">
                        <div class="d-grid gap-2">
                            <a th:href="@{/test-drives/{id}/edit(id=${testDrive.id})}" class="btn btn-outline-primary mb-2">
                                <i class="bi bi-pencil"></i> Test Sürüşü Düzenle
                            </a>
                            
                            <form th:if="${testDrive.status == T(dev.tunalime.SemesterProject.entity.TestDriveStatus).SCHEDULED}" 
                                  th:action="@{/test-drives/{id}/cancel(id=${testDrive.id})}" 
                                  method="post" 
                                  onsubmit="return confirm('Test sürüşünü iptal etmek istediğinizden emin misiniz?');">
                                <button type="submit" class="btn btn-warning w-100 mb-2">
                                    <i class="bi bi-x-circle"></i> Test Sürüşünü İptal Et
                                </button>
                            </form>
                            
                            <form th:action="@{/test-drives/{id}/delete(id=${testDrive.id})}" 
                                  method="post" 
                                  onsubmit="return confirm('Bu test sürüşünü silmek istediğinizden emin misiniz?');">
                                <button type="submit" class="btn btn-danger w-100">
                                    <i class="bi bi-trash"></i> Test Sürüşünü Sil
                                </button>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <footer th:replace="fragments/layout :: footer"></footer>
</body>
</html> 